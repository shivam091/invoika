= bootstrap_form_with model: quote_object(@quote), data: {controller: "discount-field"} do |form|
  .row
    .col-sm-12.col-md-6.col-lg-4
      = form.select :client_id, options_for_select(::User.clients.select_options, form.object.client_id),
        {include_blank: t(".select_client")}, data: {controller: "autofocus"}
    .col-sm-12.col-md-6.col-lg-4{data: {controller: "random-string-generator"}}
      = form.text_field :code, append: generate_random_code_button, data: {random_string_generator_target: "field"}
    .col-sm-12.col-md-6.col-lg-4
      = form.date_field :quote_date
    .col-sm-12.col-md-6.col-lg-4
      = form.date_field :due_date
    .col-sm-12.col-md-6.col-lg-4
      = form.select :currency, options_for_select(currencies, form.object.currency), {include_blank: t(".select_currency")}
    - if form.object.persisted?
      .col-sm-12.col-md-6.col-lg-4
        = form.select :status, enum_options_for_select(::Quote, :statuses), {include_blank: t(".select_status")}
  %hr
  %div{data: {controller: "nested-forms", nested_forms_wrapper_selector_value: ".quote-item-form-wrapper"}}
    = render_if_exists("quotes/quote_items", locals: {form:})
  %hr
  .row.mt-2
    .col-lg-7.col-sm-12.mt-2.mt-lg-0.align-right-for-full-screen
      .input-group
        = form.number_field :discount, oninput: "validity.valid || (value = value.replace(/[e\\+\\-]/gi, ''))",
          pattern: "^\\d*(\\.\\d{0,2})?$", step: ".01", min: 0, style: "width: 270px !important;", data: {discount_field_target: "discount"},
          readonly: (form.object.discount_type.nil?), disabled: (form.object.discount_type.nil?)
        = form.select :discount_type, enum_options_for_select(::Quote, :discount_types), {include_blank: t(".select_discount_type")},
          style: "width: 260px !important;", data: {discount_field_target: "discountType", action: "change->discount-field#toggleDiscountField"}
    = render_if_exists("quotes/quote_summary")
  .row
    .col-12.col-lg-6
      = form.text_area :notes
    .col-12.col-lg-6
      = form.text_area :terms
  .actions
    - if form.object.new_record?
      = button_tag type: :submit, class: "btn btn-primary" do
        = external_svg_tag("svgs/plus.svg")
        %span.d-block.d-lg-none= button_text("create")
        %span.d-none.d-lg-block= button_text("create_quote")
    - if form.object.persisted?
      = button_tag type: :submit, class: "btn btn-primary" do
        = external_svg_tag("svgs/floppy.svg")
        %span.d-block.d-lg-none= button_text("update")
        %span.d-none.d-lg-block= button_text("update_quote")
    = link_to quotes_path, class: "btn btn-secondary" do
      = external_svg_tag("svgs/cancel.svg")
      = button_text("cancel")
